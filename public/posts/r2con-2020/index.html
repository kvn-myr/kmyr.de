<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width"><meta name="description" content="Presentation at r2con 2020" />

<title>
    
    Where is my Ransom? Hunting for Ransomware Gangs using radare2 and Yara | Kevin Mayer
    
</title>

<link rel="canonical" href="https://kmyr.de/posts/r2con-2020/" />












<link rel="stylesheet" href="/assets/combined.min.a6824bbee0d90d5af09fed9b70395ce7076b615e315037455d903314e96ef91b.css" media="all">






  </head>

  

  
  
  

  <body class="auto">

    <div class="content">
      <header>
        

<div class="header">

    

    <h1 class="header-title">Kevin Mayer</h1>

    <div class="flex">
        

        
        
        <p class="small ">
            <a href="/">
                /home
            </a>
        </p>
        
        <p class="small ">
            <a href="/posts">
                /posts
            </a>
        </p>
        
        <p class="small ">
            <a href="/about">
                /about
            </a>
        </p>
        
        <p class="small ">
            <a href="/supervision">
                /supervision
            </a>
        </p>
        
        
    </div>

    

</div>
      </header>

      <main class="main">
        




<div class="breadcrumbs">
    
    <a href="/">Home</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a href="/posts/">Posts</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a class="breadcrumbs-current" href="/posts/r2con-2020/">Where is my Ransom? Hunting for Ransomware Gangs using radare2 and Yara</a>
</div>


<div >

  <div class="single-intro-container">

    

    <h1 class="single-title">Where is my Ransom? Hunting for Ransomware Gangs using radare2 and Yara</h1>
    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2020-11-05T09:31:07&#43;02:00">November 5, 2020</time>
      

      
    </p>

  </div>

  

  

  

  

  <div class="single-content">
    <h1 id="where-is-my-ransom-hunting-for-ransomware-gangs-using-radare2-and-yara">Where is my Ransom? Hunting for Ransomware Gangs using radare2 and Yara</h1>
<h2 id="abstract">Abstract</h2>
<p>ansomware gangs have gotten better and more aggressive over the past years. Their used malware is well developed and some offer ransomware-as-a-service. Specific threat actors publish the collected data, if victims do not pay the demanded ransom. This evolvement made this area an interesting research domain for me. My goal is to collect the newest samples of specific ransomware gangs and understand the different actors. I aim to share IOCs, TTPs and other insights with the community. My research should allow people, companies and other institutions to protect themselves from ransomware attacks. At the beginning of this project, I started to analyse samples from different reports by hand. To do this, I used Cutter. This task was very time consuming. In addition, I was not able to gain new insights after analysing a few samples for a specific group. The collected IOCs and TTPs were already know. So I was not able to generate benefit for anyone. So I started to raise the following question: How am I able to collect new samples for specific groups? I identified two options: First, by waiting for new incidents and the corresponding reports. Second, by hunting for ransomware gangs. Obviously, the first option is not very expedient. So I decided to hunt using Yara. I used VirusTotal and Hybrid Analysis to perform my hunts. In my talk, I will quickly explain the goal of Yara and its capabilities. In addition, I will quickly go over the syntax and present best practices I learned after failing miserably at the beginning (more in my example section of the talk). Next, I will explain how I created Yara rules using different tools around r2 (especially Cutter). I will illustrate this for two rules: The maze and clop ransomware. For each rule, I will go in detail how I created and tested them. In addition, I will explain, how I miserably failed at the beginning and what I learned during the journey.</p>
<h2 id="conference">Conference</h2>
<p>r2con2020


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/g39hut-csYE?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>
</p>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://github.com/kgbuquerin/talks-and-presentations/blob/master/r2con2020/where-is-my-ransom-kgbuquerin.pdf">Slides</a></li>
<li><a href="https://www.youtube.com/watch?v=g39hut-csYE">Video</a></li>
</ul>

    
  </div>

  

  
  

<div class="single-pagination">
    <hr />

    <div class="flex">

        <div class="single-pagination-prev">
            
            <div class="single-pagination-container-prev">
                <div class="single-pagination-text">←</div>
                <div class="single-pagination-text">
                    <a href="/posts/cs3sthlm/">
                        Presentation at the CS3STHLM 2019
                    </a>
                </div>
            </div>
            
        </div>

        <div class="single-pagination-next">
            
            <div class="single-pagination-container-next">
                <div class="single-pagination-text">
                    <a href="/posts/dfrws-2021/">
                        A Generalized Approach to Automotive Forensics
                    </a>
                </div>
                <div class="single-pagination-text">→</div>
            </div>
            
        </div>

    </div>

    <hr />
</div>



  

  

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


      </main>
    </div>

    <footer>
      

    </footer>

  </body>

  <script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>

</html>